import{r as t,c as e,h as i,H as s,a as n}from"./p-ce275af6.js";import{i as c,n as r}from"./p-e4f14b9d.js";import"./p-2f33ceac.js";import"./p-3a41f8f2.js";
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
 * v2.10.1
 */function o(t){return t?.tagName==="CALCITE-TREE-ITEM"}function l(t){return Array.from(t.querySelectorAll("calcite-tree-item:not([disabled])")).filter((e=>{let i=e;while(i!==t&&i!==undefined){const t=i.parentElement;const e=!o(t)||!t.hasChildren||t.expanded;if(!e){return false}i=i.parentElement}return true}))}const h=":host{display:block}:host(:focus){outline:2px solid transparent;outline-offset:2px}:host([hidden]){display:none}[hidden]{display:none}";const f=class{constructor(i){t(this,i);this.calciteTreeSelect=e(this,"calciteTreeSelect",6);this.keyDownHandler=t=>{if(this.child){return}const e=this.el;const i=t.target;const s=["ArrowRight","ArrowDown","ArrowLeft","ArrowUp","Home","End","Tab"];if(!(o(i)&&this.el.contains(i))||!s.includes(t.key)){return}const n=l(e);if(t.key==="Tab"){n.forEach((t=>t.tabIndex=-1));return}if(t.key==="ArrowDown"){const e=n.indexOf(i);const s=n[e+1];s===null||s===void 0?void 0:s.focus();t.preventDefault();return}if(t.key==="ArrowUp"){const e=n.indexOf(i);const s=n[e-1];s===null||s===void 0?void 0:s.focus();t.preventDefault();return}if(t.key==="ArrowLeft"){if(i.hasChildren&&i.expanded){i.expanded=false;t.preventDefault();return}const e=n.slice(0,n.indexOf(i)).reverse();const s=e.find((t=>t.depth===i.depth-1));s===null||s===void 0?void 0:s.focus();t.preventDefault();return}if(t.key==="ArrowRight"){if(!i.disabled&&i.hasChildren){if(!i.expanded){i.expanded=true;t.preventDefault()}else{const e=n.indexOf(i);const s=n[e+1];s===null||s===void 0?void 0:s.focus();t.preventDefault()}}return}if(t.key==="Home"){const e=n.shift();if(e){e.focus();t.preventDefault()}return}if(t.key==="End"){const e=n.pop();if(e){e.focus();t.preventDefault()}return}};this.lines=false;this.child=undefined;this.scale="m";this.selectionMode="single";this.selectedItems=[]}componentWillRender(){var t;const e=(t=this.el.parentElement)===null||t===void 0?void 0:t.closest("calcite-tree");this.lines=e?e.lines:this.lines;this.scale=e?e.scale:this.scale;this.selectionMode=e?e.selectionMode:this.selectionMode;this.child=!!e}render(){return i(s,{key:"60482915d0c0020ff558e562fccbb9cba064b1b2","aria-multiselectable":this.child?undefined:(this.selectionMode==="multiple"||this.selectionMode==="multichildren").toString(),onKeyDown:this.keyDownHandler,role:!this.child?"tree":undefined,tabIndex:this.getRootTabIndex()},i("slot",{key:"f9d50bf3c4c0e75be2c0f9cc9676aa7b7e703e0d"}))}onFocus(){if(!this.child){const t=this.el.querySelector("calcite-tree-item[selected]:not([disabled])")||this.el.querySelector("calcite-tree-item:not([disabled])");c(t)}}onFocusIn(t){const e=t.relatedTarget===this.el||!this.el.contains(t.relatedTarget);if(e){this.el.removeAttribute("tabindex")}}onFocusOut(t){const e=!this.el.contains(t.relatedTarget);if(e){this.el.tabIndex=this.getRootTabIndex()}}onInternalTreeItemSelect(t){if(this.child){return}const e=t.target;const i=r(e.querySelectorAll("calcite-tree-item"));t.preventDefault();t.stopPropagation();if(this.selectionMode==="ancestors"){this.updateAncestorTree(t);return}const s=this.selectionMode==="none";const n=this.selectionMode!==null&&(!e.hasChildren||e.hasChildren&&(this.selectionMode==="children"||this.selectionMode==="multichildren"));const c=this.selectionMode==="multichildren"&&e.hasChildren;const o=!s&&t.detail.modifyCurrentSelection&&(this.selectionMode==="multiple"||this.selectionMode==="multichildren");const l=!o&&((this.selectionMode==="single"||this.selectionMode==="multiple")&&i.length<=0||this.selectionMode==="children"||this.selectionMode==="multichildren"||this.selectionMode==="single-persist"&&!e.hasChildren);const h=["multiple","none","single","single-persist"].includes(this.selectionMode)&&e.hasChildren;const f=[];if(n){f.push(e)}if(l){const t=r(this.el.querySelectorAll("calcite-tree-item[selected]"));t.forEach((t=>{if(!f.includes(t)){t.selected=false}}))}if(h&&["multiple","none","single","single-persist"].includes(this.selectionMode)){e.expanded=!e.expanded}if(c){i.forEach((t=>{t.selected=false;if(t.hasChildren){t.expanded=false}}))}if(o){window.getSelection().removeAllRanges()}if(o&&e.selected){f.forEach((t=>{if(!t.disabled){t.selected=false}}))}else if(!s){f.forEach((t=>{if(!t.disabled){t.selected=this.selectionMode!=="single"||!t.selected}}))}this.selectedItems=s?[]:r(this.el.querySelectorAll("calcite-tree-item")).filter((t=>t.selected));this.calciteTreeSelect.emit();t.stopPropagation()}updateAncestorTree(t){const e=t.target;const i=t.detail.updateItem;if(e.disabled||e.indeterminate&&!i){return}const s=[];let n=e.parentElement.closest("calcite-tree-item");while(n){s.push(n);n=n.parentElement.closest("calcite-tree-item")}const c=Array.from(e.querySelectorAll("calcite-tree-item:not([disabled])"));const o=c.filter((t=>!t.hasChildren));const l=c.filter((t=>t.hasChildren));let h;if(i){h=e.hasChildren?!(e.selected||e.indeterminate):!e.selected}else{h=e.selected}o.forEach((t=>{t.selected=h;t.indeterminate=false}));function f(t,e){const i=t.filter((t=>t.selected));const s=t.filter((t=>!t.selected));e.selected=i.length===t.length;e.indeterminate=i.length>0&&s.length>0}l.reverse().forEach((t=>{const e=Array.from(t.querySelectorAll(":scope > calcite-tree > calcite-tree-item"));f(e,t)}));if(i){if(e.hasChildren){f(c,e)}else{e.selected=h;e.indeterminate=false}}s.forEach((t=>{const e=r(t.querySelectorAll("calcite-tree-item"));const i=e.filter((t=>t.selected));if(i.length===0){t.selected=false;t.indeterminate=false;return}const s=i.length<e.length;t.indeterminate=s;t.selected=!s}));this.selectedItems=r(this.el.querySelectorAll("calcite-tree-item")).filter((t=>t.selected));if(i){this.calciteTreeSelect.emit()}}getRootTabIndex(){return!this.child?0:-1}get el(){return n(this)}};f.style=h;export{f as calcite_tree};
//# sourceMappingURL=p-0b91bcb3.entry.js.map