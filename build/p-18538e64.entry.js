import{r as t,h as e,H as i,c as o}from"./p-ce275af6.js";import{s as n}from"./p-f300bd24.js";const s=":host{display:block;width:100%}";const r="https://hub.arcgis.com/api/telemetry/v1/report";const a=class{constructor(e){t(this,e);this.cardId=null;this.configuration=undefined;this.data=undefined}async fetchTelemetry(t){const e=await fetch(r,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json",Authorization:n.context.hubRequestOptions.authentication.token}});const i=JSON.parse(await e.text());return i}async updateTelemetryData(t){if(!!this.configuration){try{this.data=await this.fetchTelemetry(t);console.debug("Telemetry Data:",this.data)}catch(t){console.error("Error fetching telemetry data:",t)}}}render(){var t;return e(i,null,e("calcite-card",null,e("h2",{slot:"title"},"Card ",this.cardId),!!this.configuration&&!!((t=this.data)===null||t===void 0?void 0:t.data)&&this.renderTable(this.data),e("code",null,!!this.configuration?JSON.stringify(this.configuration,null,2):"No configuration")))}renderTable(t){const i=[];const o=[e("calcite-table-header",{heading:"Timestamp",description:""})];if(!!this.configuration.dimensions&&this.configuration.dimensions.length>0){o.push(e("calcite-table-header",{heading:"Dimension",description:this.configuration.dimensions[0]}))}if(!!this.configuration.metrics&&this.configuration.metrics.length>0){o.push(e("calcite-table-header",{heading:"Metric",description:this.configuration.metrics[0]}))}i.push(e("calcite-table-row",{slot:"table-header"},o));for(const o of t===null||t===void 0?void 0:t.data){const t=[e("calcite-table-cell",null,o["timestamp"])];if(!!this.configuration.dimensions&&this.configuration.dimensions.length>0){t.push(e("calcite-table-cell",null,o[this.configuration.dimensions[0]]))}if(!!this.configuration.metrics&&this.configuration.metrics.length>0){t.push(e("calcite-table-cell",null,o[this.configuration.metrics[0]]))}i.push(e("calcite-table-row",null,t))}return e("calcite-table",{caption:"Simple table"},i)}static get watchers(){return{configuration:["updateTelemetryData"]}}};a.style=s;const l=":host{display:block;width:400px;border:1px solid gray;padding:2rem;box-shadow:0 2px 4px rgba(0, 0, 0, 0.2)}";const c=class{constructor(e){t(this,e);this.telemetryConfigurationUpdated=o(this,"telemetryConfigurationUpdated",7);this.schema={type:"object",required:["hostname"],properties:{hostname:{type:"string",maxLength:255,default:"dc.esri.com"},startDate:{type:"string",default:"2024-07-01"},endDate:{type:"string",default:"2024-08-01"},metrics:{type:"string",enum:["page-views:count","other-events:count"],default:"page-views:count"},dimensions:{type:"string",enum:["","contentId","dimension2"],default:""},timeDimension:{type:"string",enum:["hour","day","week","month"],default:"day"},orderByName:{type:"string",enum:["day","page-views:count","other-events:count"],default:"day"},orderByDirection:{type:"string",enum:["asc","desc"],default:"asc"}}};this.uiSchema={type:"Layout",elements:[{label:"Hostname",scope:"/properties/hostname",type:"Control",options:{}},{label:"Start Date",scope:"/properties/startDate",type:"Control",options:{control:"hub-field-input-date"}},{label:"End Date",scope:"/properties/endDate",type:"Control",options:{control:"hub-field-input-date"}},{label:"Metrics",scope:"/properties/metrics",type:"Control",options:{control:"hub-field-input-radio-group"}},{label:"Dimensions",scope:"/properties/dimensions",type:"Control",options:{control:"hub-field-input-radio-group",labels:["None","Content ID","User Type"]}},{label:"timeDimension",scope:"/properties/timeDimension",type:"Control",options:{control:"hub-field-input-radio-group"}},{label:"Order by Name",scope:"/properties/orderByName",type:"Control",options:{control:"hub-field-input-radio-group"}},{label:"Order by Direction",scope:"/properties/orderByDirection",type:"Control",options:{control:"hub-field-input-radio-group",labels:["Ascending","Descending"]}}]};this.cardId=null;this.configuration={}}convertConfiguration(t){const e={scope:{hostname:t.hostname},dateRange:{startDate:t.startDate,endDate:t.endDate},metrics:[t.metrics],timeDimension:t.timeDimension,orderBy:[{name:t.orderByName,direction:t.orderByDirection}]};if(!!t.dimensions&&t.dimensions.length>0){e.dimensions=[t.dimensions]}return e}async configurationChanged(t){const e=this.convertConfiguration(t.detail.values);console.debug("telemetry-card-editor: updateConfiguration",e);this.telemetryConfigurationUpdated.emit({cardId:this.cardId,configuration:e})}render(){return e(i,null,e("slot",null),e("h3",{slot:"title"},"Card Editor"),e("div",{slot:"content"},e("arcgis-configuration-editor",{schema:this.schema,uiSchema:this.uiSchema,values:this.configuration})))}};c.style=l;export{a as telemetry_card,c as telemetry_card_editor};
//# sourceMappingURL=p-18538e64.entry.js.map